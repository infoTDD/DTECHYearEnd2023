<!-- Stage- Bootstrap one page Event ticket booking theme 
Created by pixpalette.com - online design magazine -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>DTECH Events</title>

    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/custom.css" rel="stylesheet">
    
    <!-- fonts -->
    <link href='https://fonts.googleapis.com/css?family=Nixie+One' rel='stylesheet' type='text/css'>
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700,900" rel="stylesheet">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
  	
    <div class="loader">
       <div>
        <img src="images/icons/preloader.gif" />
       </div>
    </div>
    
    <div class="container-fluid">
		<div class="row">
        	<div class="col-sm-5 left-wrapper">
            	<div class="event-banner-wrapper">
                	<div class="logo">
                        <h1>AB InBev Africa Head Office Year End Celebration!</h1>
                    </div>
                
                	 <h2>Year End<br>Party <span>24 November 2023, 2PM until 10PM</span></h2>
                    
                </div>
            </div>
            <div class="col-sm-7 right-wrapper">
            	<div class="event-ticket-wrapper">
                    
                    <div class="event-tab">
                
                  <!-- Nav tabs -->
                  <ul class="nav nav-tabs" role="tablist">
                    <li role="presentation" class="active"><a href="#buyTicket" aria-controls="buyTicket" role="tab" data-toggle="tab">Get Ticket</a></li>
                    <li role="presentation"><a href="#venue" aria-controls="venue" role="tab" data-toggle="tab">Venue Information</a></li>
                   
                    
                    <li role="presentation"><a href="#termCondition" aria-controls="termCondition" role="tab" data-toggle="tab">Important Information</a></li>
                  </ul>
                
                  <!-- Tab panes -->
                  <div class="tab-content">
                    <div role="tabpanel" class="tab-pane fade in active" id="buyTicket">
                    	<div class="row">
                        	<div class="col-md-6">
                            	<div class="ticketBox" data-ticket-price="0">
                                	<div class="inactiveStatus"></div>
                                    
                                    <div class="row">
 			                       	<div class="col-xs-6">
            							<div class="ticket-name">
                                        	General Admision
                                            <span><strong>Date: 24 Nov 2023 <br>
												Time: 2PM to 10PM </strong><br>
                                        	1 Ticket for 1 person</span>
                                        </div>
            						</div>
                                    
                                    <div class="col-xs-6">
            							<div class="ticket-price-count-box">
                                            <div class="ticket-control">
                                                <div class="input-group">
                                                  <span class="input-group-btn">
                                                      <button type="button" class="btn btn-default btn-number" disabled="disabled" data-type="minus" data-field="quant[1]">
                                                          <span class="glyphicon glyphicon-minus"></span>
                                                      </button>
                                                  </span>
                                                  <input type="text" name="quant[1]" class="form-control input-number" value="0" min="0" max="1">
                                                  <span class="input-group-btn">
                                                      <button type="button" class="btn btn-default btn-number" data-type="plus" data-field="quant[1]">
                                                          <span class="glyphicon glyphicon-plus"></span>
                                                      </button>
                                                  </span>
                                                </div>
                                            </div>
                                            <p class="price"></p>
                                        </div>
            						</div>
                                    </div>
                                	
                                    
                                    <div class="ticket-description">
                                    	<p><br>Dear Beer Lover <br><br>
										Get ready for a day filled with laughter and good company as we celebrate our 2023 achievements at the <strong>AB InBev Africa Head Office Year End Celebration!</strong> <br><br>We’ve got a couple of surprises up our sleeves and a playlist that will have you dancing through the night.<br><br>
										Our dress code is smart casual, since it is a work function, kindly remember to dress appropriately, we’d love to see you looking your best!<br><br>
										Can’t wait to enjoy the last cheers moment of 2023 with you!</p>
                                    </div>
                                            
                                </div>
                            </div>                          
                        </div>
                    </div>
                    <div role="tabpanel" class="tab-pane fade" id="venue">
                   	<h4> <strong>Altitude Beach</strong>,<br> Fourways Boulevard,<br> Johannesburg,<br> Gauteng,<br> (Next to BOUNCE & Adventure Golf)</h4><br>
                        <iframe src="https://www.google.com/maps/embed?pb=!1m14!1m8!1m3!1d3585.442833114764!2d28.0087663!3d-26.019063!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x1e9577c1e6b251fb%3A0x2e444c90a22a52d3!2sAltitude%20Beach!5e0!3m2!1sen!2sza!4v1699339332641!5m2!1sen!2sza" width="640" height="300"></iframe>
				   </div>
                    <div role="tabpanel" class="tab-pane fade" id="termCondition">
           				<h4><p>
						&#8226; This is a closed, private AB InBev Africa/South African Breweries event<br>
						&#8226; Smart casual – dress appropriately for a work function<br>
						&#8226; Only invited head office employees will be permitted to attend<br>
						&#8226; Entry upon registration and presentation of valid ticket only<br>
						&#8226; One entry per person<br>
						&#8226; Doors open between 14:00 - 18:30, no entry will be allowed after doors close<br>
						&#8226; Be SHARP and use the uber voucher provided
					</p></h4>
                    </div>
                  </div>
                
                </div>
                
                	<div class="cart">
                <div class="row">
                    <div class="col-xs-6">
                        <p> 
                        	<span class="ticket-count">0</span> Tickets <span class="divider"> </span> 
							<strong style="color: #2c0a63;">Powered By DTECH and TaDa Drinks Delivery</strong>

							<!-- Total: Rs. <span class="total-amount">0</span> -->
							
							</p>
                    </div>
                    <div class="col-xs-6">
                    	<div class="text-right">
                        	<a class="btn disabled" data-toggle="modal" data-target="#ticket-details">PROCEED</a>
                        </div>
                    </div>
                </div>
                </div>
                       
                </div>
            </div>
        </div>
    </div>

<!-- Modal -->
<div class="modal right fade" id="ticket-details" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <!--<div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">Share your contact Details</h4>
      </div>-->
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
        	<img src="images/icons/cancel.png">
        </button>
        <h4 class="modal-title">Your Tickets</h4>
      </div>
      <div class="modal-body">
        
        <div class="cart-information">
            	<div class="ticket-type"></div>
          		<ul>
	                <li>Tickets: <span class="ticket-count"></span></li>
                    <!-- <li>Price: <span class="ticket-amount"></span></li> -->
                    <hr>
                    <!-- <li>Total: <span class="total-amount"></span></li> -->
    			</ul>
            </div>
            
            <div class="contactForm">	
                <h3>Contact Details</h3>
                <form>
                                   
                  <div class="form-group">
				   <label for="emailInput">Email</label>
                    <input type="text" class="form-control" id="emailInput" placeholder="Enter your Email Address">
                  </div>
                  
				   <div class="form-group">
				    <label for="referenceInput">Reference</label>
                    <input type="text" class="form-control" id="referenceInput" placeholder="Enter your Reference Code">
                  </div>                  
        		  <!-- <a type="submit" class="btn">Complete Booking</a> -->
				  <a href="#" id="completeBooking" class="btn">Complete Booking</a>

                </form>
			<div id="bookingResult" class="text-center" style="margin-top: 20px; font-size: 18px; font-weight: bold;"></div>


            </div>
        
        
        
      </div>
    </div>
  </div>
</div>
    
    
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap.min.js"></script>
    <script src="js/allscript.js"></script>
	<script>
	
       // Function to decode Base64-encoded string
        function decodeParam(encodedString) {
            const decodedString = atob(encodedString);
            return decodedString;
        }

        // Get the URL parameters
        const urlParams = new URLSearchParams(window.location.search);
        const emailParam = urlParams.get('code');
        const idParam = urlParams.get('id');

        // Decode and set the email and id in the input fields
        const emailInput = document.getElementById('emailInput');
        const referenceInput = document.getElementById('referenceInput');

        // Check if emailParam and idParam have values
        if (emailParam) {
            const decodedEmail = decodeParam(emailParam);
            emailInput.value = decodedEmail;
            emailInput.readOnly = true; // Set as read-only
        }

        if (idParam) {
            const decodedId = decodeParam(idParam);
            referenceInput.value = decodedId;
            referenceInput.readOnly = true; // Set as read-only
        }
	</script>
	<script>
    // ... Previous JavaScript code ...

    document.getElementById('completeBooking').addEventListener('click', function (e) {
        e.preventDefault();

        // Get values from input fields
        var emailInput = document.getElementById('emailInput').value;
        var referenceInput = document.getElementById('referenceInput').value;

        // Create JSON object
        var data = {
            "TicketNumber": emailInput,
            "Reference": referenceInput
        };
		// Reference to the completeBooking button
		var completeBookingButton = document.getElementById('completeBooking');
		
		// Disable the button and change its text
		completeBookingButton.innerHTML = 'Processing...'; // Change the text
		completeBookingButton.setAttribute('disabled', 'true'); // Disable the button
        // Send POST request to Google Apps Script webhook
        fetch('https://worker-email-register-event.krishgkrish.workers.dev/', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(data)
        })
        .then(function (response) {
            return response.text();
        })
        .then(function (result) {
            // Display the API response in the result div
            var bookingResultDiv = document.getElementById('bookingResult');
            bookingResultDiv.innerHTML = 'Registration Status : ' + result + '<br>Thank you for registering!';
			// Re-enable the button and change its text
			completeBookingButton.innerHTML = 'Registration Complete'; // Change the text
			completeBookingButton.setAttribute('disabled', 'true'); // Disable the button

        })
        .catch(function (error) {
            console.error('Error:', error);
            // Display error message in the result div
            var bookingResultDiv = document.getElementById('bookingResult');
            bookingResultDiv.innerHTML = 'Error: Unable to submit the form.';
			// Re-enable the button and change its text
			completeBookingButton.innerHTML = 'Complete Booking'; // Change the text back
			completeBookingButton.setAttribute('disabled', 'false'); // Disable the button
        });
    });
</script>
  </body>
</html>
